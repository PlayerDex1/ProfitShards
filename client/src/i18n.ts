import React, { createContext, useContext, useEffect, useMemo, useState } from 'react';

type Lang = 'pt' | 'en';

type Dict = Record<string, string>;

const dicts: Record<Lang, Dict> = {
  pt: {
    'header.title': 'ProfitShards',
    'header.subtitle': 'ProfitShards Tools: Builds, Drops, Results',
    'header.login': 'Entrar',
    'header.logout': 'Sair',
    'header.theme': 'Alternar tema',
    'header.lang': 'Idioma',

    'auth.title': 'Entrar',
    'auth.username': 'Apelido',
    'auth.password': 'Senha',
    'auth.cancel': 'Cancelar',
    'auth.login': 'Entrar',
    'auth.note': 'As credenciais ficam apenas no seu navegador.',

    'equipment.title': 'Equipamento - ',
    'equipment.config': 'Configura√ß√£o de equipamento para esta sess√£o',
    'equipment.rarity': 'Raridade',
    'equipment.luck': 'Sorte',
    'equipment.totalLuck': 'Total de Sorte',
    'equipment.save': 'Salvar',
    'equipment.cancel': 'Cancelar',
    'equipment.apply': 'Aplicar',
    'equipment.applyBuildB': 'Aplicar Build B',
    'equipment.builds': 'Builds Salvas',
    'equipment.builds.none': 'Nenhuma build salva ainda',
    'equipment.builds.name': 'Nome da build',
    'equipment.export': 'Exportar (copiar)',
    'equipment.import': 'Importar',
    'equipment.exportFile': 'Baixar JSON',
    'equipment.importFile': 'Carregar JSON',
    'equipment.share': 'Compartilhar link',
    'equipment.compare': 'Comparar Builds',
    'equipment.selectA': 'Selecione Build A',
    'equipment.selectB': 'Selecione Build B',
    'equipment.luckA': 'Sorte A',
    'equipment.luckB': 'Sorte B',
    'equipment.diff': 'Diferen√ßa',
    'equipment.effect': 'Efeito estimado',
    'equipment.tip.title': 'Dica',
    'equipment.tip.body': 'Use os presets de raridade e os bot√µes ¬± para ajustes r√°pidos. Suas builds e sess√µes s√£o salvas por usu√°rio.',
    'equipment.whatif': 'What‚Äëif de Sorte',
    'equipment.whatif.hint': 'Ajuste para simular total de Sorte e ver impacto nos c√°lculos.',
    'equipment.compareNote': 'A diferen√ßa e o efeito s√£o estimativas baseadas apenas na Sorte total.',
    'equipment.import.prompt': 'Cole o JSON das builds:',
    'equipment.button': 'Equipamento (Sorte: {luck})',
    'equipment.slot.weapon': 'Arma',
    'equipment.slot.axe': 'Machado',
    'equipment.slot.armor': 'Armadura',
    'equipment.slot.pickaxe': 'Picareta',
    'equipment.rarity.comum': 'Comum',
    'equipment.rarity.incomum': 'Incomum',
    'equipment.rarity.raro': 'Raro',
    'equipment.rarity.√©pico': '√âpico',
    'equipment.rarity.lend√°rio': 'Lend√°rio',
    'equipment.rarity.m√≠tico': 'M√≠tico',

    'results.totalTokenValue': 'Valor Total dos Tokens',
    'results.gemsCost': 'Custo das Gemas',
    'results.grossProfit': 'Lucro Bruto',
    'results.rebuyCost': 'Custo Recompra Gemas',
    'results.roi': 'ROI',
    'results.no_history': 'Nenhum c√°lculo salvo ainda',
    'results.history_will_appear': 'Seus c√°lculos aparecer√£o aqui automaticamente',
    'results.finalProfitTitle': 'Lucro L√≠quido Final',
    'results.finalProfit': 'Lucro Final',
    'results.profitable': 'Investimento Lucrativo',
    'results.loss': 'Preju√≠zo',
    'results.summaryTitle': 'Resumo',
    'results.tokenDistribution': 'Distribui√ß√£o de Tokens',
    'results.equipTokens': 'Tokens gastos em acelera√ß√£o',
    'results.farmedTokens': 'Tokens Farmados',
    'results.totalTokensCount': 'Total de Tokens',
    'results.efficiencyMetrics': 'M√©tricas de Efici√™ncia',
    'results.totalTokensLabel': 'Total de Tokens',
    'results.netTokens': 'Tokens L√≠quidos',
    'results.farmEfficiency': 'Efici√™ncia Farm',
    'results.performanceOverTime': 'Performance ao Longo do Tempo',
    'results.history.title': 'Hist√≥rico de C√°lculos',
    'results.history.show': 'Mostrar',
    'results.history.hide': 'Ocultar',
    'results.history.clear': 'Limpar',
    'results.history.clickToShow': 'Clique em "Mostrar" para ver o hist√≥rico',
    'results.tokenLabel': 'Tokens',
    'results.profitLabel': 'Lucro',

    '404.title': '404 P√°gina n√£o encontrada',
    '404.hint': 'Voc√™ esqueceu de adicionar a p√°gina ao roteador?',

    'calc.title': 'Calculadora',
    'calc.investment': 'Investimento Inicial (USD)',
    'calc.gemsConsumed': 'Gemas Consumidas',
    'calc.loadsUsed': 'Cargas Utilizadas',
    'calc.gemsPurchased': 'Gemas Compradas',
    'calc.tokensEquipment': 'Token gasto na acelera√ß√£o',
    'calc.tokenPrice': 'Pre√ßo Token (USD)',
    'calc.currentPrice': 'Pre√ßo atual WorldShards',
    'calc.updated': 'Atualizado',
    'calc.outdated': 'Desatualizado',
    'calc.refreshPrice': 'Atualizar pre√ßo do token',
    'calc.error': 'Erro',
    'calc.gemsRemaining': 'Gemas Restantes',
    'calc.tokensFarmed': 'Tokens Farmados',
    'calc.gemPrice': 'Pre√ßo Gema (USD)',
    'calc.button': 'Salvar no Hist√≥rico',

    'sidebar.summary': 'Resumo R√°pido',
    'sidebar.totalProfit': 'Lucro Total',
    'sidebar.roi': 'ROI',
    'sidebar.efficiency': 'Efici√™ncia',
    'sidebar.nav.calculator': 'Calculadora',
    'sidebar.nav.equipment': 'Equipamentos',
    'sidebar.nav.history': 'Hist√≥rico',

    'home.calculator': 'Calculadora',
    'home.title': 'ProfitShards Tools',
    'home.hero.title': 'Maximize Seus Lucros',
    'home.hero.subtitle': 'Calcule, planeje e otimize seus farmings no WorldShards com ferramentas profissionais e dados da comunidade.',
    'home.hero.cta.start': 'Come√ßar a Calcular',
    'home.hero.cta.register': 'Criar Conta Gr√°tis',
    'home.features.title': 'Suas Ferramentas de Sucesso',
    'home.features.subtitle': 'Tudo que voc√™ precisa para dominar o WorldShards em um s√≥ lugar',
    'home.features.calculator.title': 'Calculadora Avan√ßada',
    'home.features.calculator.description': 'Calcule seus lucros com precis√£o, considerando todos os fatores: investimento, gems, luck e efici√™ncia.',
    'home.features.calculator.badge1': 'ROI em tempo real',
    'home.features.calculator.badge2': 'Simula√ß√£o avan√ßada',
    'home.features.map.title': 'Planejador de Mapas',
    'home.features.map.description': 'Registre suas runs, analise efici√™ncia e contribua para as estat√≠sticas da comunidade.',
    'home.features.map.badge1': 'Hist√≥rico completo',
    'home.features.map.badge2': 'M√©tricas detalhadas',
    'home.features.analytics.title': 'Analytics Avan√ßados',
    'home.features.analytics.description': 'Dashboards completos, hist√≥rico detalhado e insights para otimizar sua estrat√©gia.',
    'home.features.analytics.badge1': 'Gr√°ficos din√¢micos',
    'home.features.analytics.badge2': 'Compara√ß√µes',
    'home.community.title': 'Atividade da Comunidade',
    'home.community.subtitle': 'Veja em tempo real o que outros players est√£o fazendo. Inspire-se e compita!',
    'home.cta.title': 'Pronto para Come√ßar Sua Jornada? üöÄ',
    'home.cta.subtitle': 'Junte-se a centenas de players que j√° est√£o maximizando seus lucros no WorldShards',
    
    // Login Required Messages
    'home.loginRequired.all': 'üîê Fa√ßa login para acessar todas as funcionalidades!\n\nEntre com sua conta para usar a Calculadora, Planejador e Estat√≠sticas.',
    'home.loginRequired.feed': 'üîê Fa√ßa login para aparecer no feed da comunidade!\n\nUse as ferramentas e suas atividades aparecer√£o aqui para todos verem.',
    'home.loginRequired.calculator': 'üîê Fa√ßa login para acessar a Calculadora!\n\nAcesse seu perfil para come√ßar a calcular seus lucros.',
    'home.loginRequired.planner': 'üîê Fa√ßa login para acessar o Planejador de Mapas!\n\nAcesse seu perfil para planejar suas estrat√©gias.',
    'home.loginRequired.stats': 'üîê Fa√ßa login para acessar as Estat√≠sticas!\n\nAcesse seu perfil para ver seu dashboard completo.',
    'home.loginRequired.giveaway': 'üîê Fa√ßa login para participar do Giveaway!\n\nEntre com sua conta para concorrer aos pr√™mios.',
    'home.walletCopied': 'Carteira copiada para a √°rea de transfer√™ncia!',
    'home.cta.try': 'Experimentar Agora (Gr√°tis)',
    'home.cta.features': 'Ver Mais Features',
    'home.footer.description': 'A plataforma definitiva para farming inteligente. Desenvolvida pela comunidade, para a comunidade.',
    'home.footer.feature1': 'C√°lculos Precisos',
    'home.footer.feature2': 'Analytics Avan√ßados',
    'home.footer.feature3': 'Comunidade Ativa',
    'home.footer.feature4': 'Totalmente Gratuito',
    'home.welcome.title': 'Bem-vindo de volta, {username}! üëã',
    'home.welcome.subtitle': 'Pronto para mais uma sess√£o de farming lucrativo?',
    'home.welcome.profile': 'Ir ao Perfil',
    'home.goToProfile': 'Acessar Ferramentas',
    'home.startCalculating': 'Come√ßar a Calcular',
    
    // WorldShards Resources Section
    'home.resources.title': 'Acesse o jogo, marketplace e tire suas d√∫vidas',
    'home.resources.yourTurn': 'Sua vez!',
    'home.resources.makeRun': 'Fa√ßa sua run e apare√ßa aqui para toda a comunidade ver',
    'home.resources.startCalculating': 'Come√ßar a Calcular',
    
    // Support Section
    'support.feedback': 'Feedback & Suporte',

    // Navigation
    'nav.backToMain': 'Voltar ao Menu Principal',
    'nav.openProfile': 'Abrir Perfil (Sorte: {luck})',
    'nav.openProfileUser': 'Abrir Perfil ({user})',

    'auth.guest': 'Convidado',

    'donate.title': 'Doa√ß√£o',
    'donate.openloot': 'Creator OL',
    'donate.wallet': 'Carteira EVM',
    'donate.copy': 'Copiar',
    'donate.copied': 'Copiado!',
    'support.title': 'Apoie o Projeto',
    'support.ambassador': 'OpenLoot (Embaixador)',
    'support.ambassador.cta': 'Ambassador OpenLoot',
    'support.ambassador.desc': 'Use meu link de embaixador',
    'support.donate': 'Doe para manter o site online',
    'support.creator': 'Criado por',
    'planner.title': 'Planejador de Mapa',
    'planner.mapSize': 'Tamanho do mapa',
    'planner.small': 'Pequeno',
    'planner.medium': 'M√©dio',
    'planner.large': 'Grande',
    'planner.xlarge': 'Extra grande',
    'planner.energyCost': 'Energia por mapa',
    'planner.loads': 'Cargas (n¬∫ de runs)',
    'planner.tokensDropped': 'Tokens dropados',
    'planner.luck': 'Sorte (Luck)',
    'planner.status': 'Status',
    'planner.apply': 'Salvar no mini hist√≥rico',
    'planner.example': 'ex.: 30 no mapa m√©dio',
    'planner.history': 'Mini hist√≥rico (2 dias)',
    'planner.noHistory': 'Nenhum registro de drop nos √∫ltimos 2 dias',
    'planner.when': 'Quando',
    'metrics.title': 'M√©tricas (√∫ltimos 2 dias)',
    'metrics.title24h': 'M√©tricas (√∫ltimas 24h)',
    'metrics.avgPerRun': 'M√©dia de tokens por carga',
    'metrics.totalByDay': 'Total por dia',
    'metrics.bestHour': 'Melhor hor√°rio',
    'metrics.noData': 'Sem dados suficientes',
    'metrics.todayTitle': 'M√©tricas (hoje desde 05:00)',
    'metrics.avgPerRunToday': 'M√©dia de tokens por carga (hoje)',
    'metrics.totals': 'Totais',
    'metrics.todayFromTime': 'Hoje (desde 05:00)',
    'metrics.yesterdayRange': 'Ontem (05:00 ‚Üí 05:00)',
    'metrics.bestHourToday': 'Melhor hor√°rio (hoje)',
    'metrics.runShort': 'carga',
    'planner.clear': 'Limpar hist√≥rico',
    'planner.delete': 'Excluir',

    // WorldShards Resources
    'resources.game.title': 'Jogar Agora',
    'resources.game.desc': 'Acesse o jogo WorldShards e comece sua aventura',
    'resources.game.cta': 'Jogar',
    'resources.marketplace.title': 'Marketplace',
    'resources.marketplace.desc': 'Compre e venda items, equipamentos e tokens',
    'resources.marketplace.cta': 'OpenLoot',
    'resources.faq.title': 'FAQ & Ajuda',
    'resources.faq.desc': 'Perguntas frequentes e guias de uso',
    'resources.faq.cta': 'Ver FAQ',

    // FAQ Section
    'faq.title': 'Perguntas Frequentes',
    'faq.subtitle': 'Tire suas d√∫vidas sobre o WorldShards Calculator',
    'faq.calculator.question': 'Como funciona a calculadora de lucros?',
    'faq.calculator.answer': 'A calculadora analisa seu investimento, equipamentos, sorte e efici√™ncia para determinar o lucro potencial nas dungeons. Insira os dados do seu setup e receba uma an√°lise detalhada com ROI, distribui√ß√£o de tokens e recomenda√ß√µes.',
    'faq.planner.question': 'O que √© o planejador de mapas?',
    'faq.planner.answer': 'O planejador permite registrar suas runs, analisar efici√™ncia por mapa (Small, Medium, Large, XLarge) e contribuir para as estat√≠sticas da comunidade. Acompanhe seu progresso e compare com outros jogadores.',
    'faq.stats.question': 'Como funcionam as estat√≠sticas da comunidade?',
    'faq.stats.answer': 'As estat√≠sticas s√£o atualizadas em tempo real com dados an√¥nimos dos usu√°rios. Voc√™ pode ver runs recentes, lucros totais, players ativos e mapas mais populares. Todos os dados s√£o agregados e n√£o identificam usu√°rios individuais.',
    'faq.tokens.question': 'Os pre√ßos dos tokens s√£o atualizados automaticamente?',
    'faq.tokens.answer': 'Atualmente usamos pre√ßos fixos para c√°lculos. Em breve implementaremos integra√ß√£o com APIs de pre√ßos em tempo real para refletir as cota√ß√µes atuais do mercado. Voc√™ pode acompanhar pre√ßos atuais no CoinGecko.',
    'faq.export.question': 'Posso exportar meus dados e hist√≥rico?',
    'faq.export.answer': 'Sim! No perfil voc√™ pode baixar todo seu hist√≥rico de c√°lculos e runs em formato JSON. Tamb√©m √© poss√≠vel limpar dados individualmente ou fazer backup completo de suas informa√ß√µes.',
    'faq.offline.question': 'O site funciona offline?',
    'faq.offline.answer': 'Parcialmente sim! A calculadora e hist√≥rico funcionam offline ap√≥s o primeiro carregamento. Apenas recursos que dependem de dados da comunidade (feed, estat√≠sticas) precisam de conex√£o com internet.',

    // Status labels
    'status.excellent': 'Excelente',
    'status.positive': 'Positivo',
    'status.negative': 'Negativo',
    'status.neutral': 'Neutro',

    // Profile page
    'profile.title': 'Perfil',
    'profile.welcome': 'Ol√°, {name}! üëã',
    'profile.subtitle': 'Configura√ß√µes e hist√≥rico sincronizados automaticamente',
    'profile.subtitleLocal': 'Dados salvos localmente no navegador',
    'profile.of': 'Perfil de {name}',
    'profile.tabs.calculator': 'Calculadora',
    'profile.tabs.history': 'Hist√≥rico',
    'profile.tabs.planner': 'Planejador',
    'profile.tabs.test': 'Test',
    'profile.history.clear': 'Limpar Tudo',
    'profile.history.empty': 'Fa√ßa alguns c√°lculos na p√°gina inicial para ver o hist√≥rico aqui',
    'profile.history.stats.title': 'Resumo Estat√≠stico',
    'profile.history.stats.calculations': 'C√°lculos',
    'profile.history.stats.avgProfit': 'Lucro M√©dio',
    'profile.history.stats.bestProfit': 'Melhor Lucro',
    'profile.history.stats.successRate': 'Taxa Sucesso',
    'profile.history.remove': 'Remover',
    'profile.history.removeTitle': 'Remover este c√°lculo',
    'profile.history.investment': 'Investimento',
    'profile.history.tokens': 'Tokens',
    'profile.history.gems': 'Gemas',
    'profile.history.efficiency': 'Efici√™ncia',

    // Equipment settings
    'equipment.userSettings': 'Configura√ß√µes do Usu√°rio',
    'equipment.nickname': 'Nickname',
    'equipment.nicknameEdit': 'Editar',
    'equipment.nicknameSave': 'Salvar',
    'equipment.nicknameCancel': 'Cancelar',
    'equipment.nicknamePlaceholder': 'Digite seu nickname',
    'equipment.nicknameDescription': 'Seu nickname ser√° exibido publicamente nos rankings e estat√≠sticas',
    'equipment.nicknameLoading': 'Carregando...',

    // Analytics Dashboard
    'analytics.title': 'Analytics Avan√ßados',
    'analytics.globalData': 'Dados Globais',
    'analytics.adminTools': 'Ferramentas Admin',
    'analytics.update': 'Atualizar',
    'analytics.loading': 'Carregando analytics...',
    'analytics.loadingGlobal': 'Carregando dados globais...',
    'analytics.hourlyActivity': 'Atividade por Hor√°rio',
    'analytics.mapEfficiency': 'Efici√™ncia por Mapa',
    'analytics.topUsers': 'Top Usu√°rios',
    'analytics.totalRuns': 'Total Runs',
    'analytics.totalTokens': 'Total Tokens',
    'analytics.activeUsers': 'Usu√°rios Ativos',
    'analytics.globalAverage': 'M√©dia Global',
    'analytics.luckRange': 'Faixa de Luck',
    'analytics.runs': 'Runs',
    'analytics.tokens': 'Tokens',
    'analytics.average': 'M√©dia',
    'analytics.users': 'Usu√°rios',

    // Admin Tools
    'admin.title': 'Ferramentas Administrativas',
    'admin.exportData': 'Exportar Dados',
    'admin.exportDescription': 'Baixar todos os dados do sistema',
    'admin.exportCSV': 'CSV',
    'admin.exportJSON': 'JSON',
    'admin.backupDatabase': 'Backup Database',
    'admin.backupDescription': 'Criar backup completo do D1',
    'admin.createBackup': 'Criar Backup',
    'admin.cleanData': 'Limpeza de Dados',
    'admin.cleanDescription': 'Remover dados antigos (90+ dias)',
    'admin.cleanOld': 'Limpar Antigos',
    'admin.testD1': 'Teste D1',
    'admin.testD1Description': 'Testar conectividade do banco',
    'admin.testDatabase': 'Testar D1',
    'admin.processing': 'Processando...',

    // Test Dashboard
    'test.dashboard': 'Dashboard Teste',
    'test.worldshards': 'WorldShards Dashboard',
    'test.subtitle': 'An√°lises em tempo real e insights de farming',
    'test.totalFarms': 'Total de Farms',
    'test.totalTokens': 'Total de Tokens',
    'test.avgEfficiency': 'Efici√™ncia M√©dia',
    'test.activeUsers': 'Usu√°rios Ativos',
    'test.hourlyActivity': 'Atividade por Hora',
    'test.topMaps': 'Top Mapas',
    'test.recentActivity': 'Atividade Recente',
    'test.efficiencyTrends': 'Tend√™ncias de Efici√™ncia',

    // Common
    'common.error': 'Erro',
    'common.success': 'Sucesso',
    'common.loading': 'Carregando',
    'common.save': 'Salvar',
    'common.cancel': 'Cancelar',
    'common.edit': 'Editar',
    'common.delete': 'Excluir',
    'common.copy': 'Copiar',
  },
  en: {
    'header.title': 'ProfitShards',
    'header.subtitle': 'ProfitShards Tools: Builds, Drops, Results',
    'header.login': 'Sign in',
    'header.logout': 'Sign out',
    'header.theme': 'Toggle theme',
    'header.lang': 'Language',

    'auth.title': 'Sign in',
    'auth.username': 'Nickname',
    'auth.password': 'Password',
    'auth.cancel': 'Cancel',
    'auth.login': 'Sign in',
    'auth.note': 'Credentials are stored only in your browser.',

    'equipment.title': 'Equipment - ',
    'equipment.config': 'Equipment configuration for this session',
    'equipment.rarity': 'Rarity',
    'equipment.luck': 'Luck',
    'equipment.totalLuck': 'Total Luck',
    'equipment.save': 'Save',
    'equipment.cancel': 'Cancel',
    'equipment.apply': 'Apply',
    'equipment.applyBuildB': 'Apply Build B',
    'equipment.builds': 'Saved Builds',
    'equipment.builds.none': 'No builds saved yet',
    'equipment.builds.name': 'Build name',
    'equipment.export': 'Export (copy)',
    'equipment.import': 'Import',
    'equipment.exportFile': 'Download JSON',
    'equipment.importFile': 'Upload JSON',
    'equipment.share': 'Share link',
    'equipment.compare': 'Compare Builds',
    'equipment.selectA': 'Select Build A',
    'equipment.selectB': 'Select Build B',
    'equipment.luckA': 'Luck A',
    'equipment.luckB': 'Luck B',
    'equipment.diff': 'Difference',
    'equipment.effect': 'Estimated effect',
    'equipment.tip.title': 'Tip',
    'equipment.tip.body': 'Use rarity presets and ¬± buttons for quick adjustments. Your builds and sessions are saved per user.',
    'equipment.whatif': 'Luck What‚Äëif',
    'equipment.whatif.hint': 'Adjust to simulate total Luck and see impact.',
    'equipment.compareNote': 'Difference and effect are estimates based only on total Luck.',
    'equipment.import.prompt': 'Paste builds JSON:',
    'equipment.button': 'Equipment (Luck: {luck})',
    'equipment.slot.weapon': 'Weapon',
    'equipment.slot.axe': 'Axe',
    'equipment.slot.armor': 'Armor',
    'equipment.slot.pickaxe': 'Pickaxe',
    'equipment.rarity.comum': 'Common',
    'equipment.rarity.incomum': 'Uncommon',
    'equipment.rarity.raro': 'Rare',
    'equipment.rarity.√©pico': 'Epic',
    'equipment.rarity.lend√°rio': 'Legendary',
    'equipment.rarity.m√≠tico': 'Mythic',

    'results.totalTokenValue': 'Total Token Value',
    'results.gemsCost': 'Gems Cost',
    'results.grossProfit': 'Gross Profit',
    'results.rebuyCost': 'Gems Rebuy Cost',
    'results.roi': 'ROI',
    'results.no_history': 'No calculations saved yet',
    'results.history_will_appear': 'Your calculations will appear here automatically',
    'results.finalProfitTitle': 'Final Net Profit',
    'results.finalProfit': 'Final Profit',
    'results.profitable': 'Profitable Investment',
    'results.loss': 'Loss',
    'results.summaryTitle': 'Summary',
    'results.tokenDistribution': 'Token Distribution',
    'results.equipTokens': 'Tokens spent on acceleration',
    'results.farmedTokens': 'Farmed Tokens',
    'results.totalTokensCount': 'Total Tokens',
    'results.efficiencyMetrics': 'Efficiency Metrics',
    'results.totalTokensLabel': 'Total Tokens',
    'results.netTokens': 'Net Tokens',
    'results.farmEfficiency': 'Farm Efficiency',
    'results.performanceOverTime': 'Performance Over Time',
    'results.history.title': 'Calculations History',
    'results.history.show': 'Show',
    'results.history.hide': 'Hide',
    'results.history.clear': 'Clear',
    'results.history.clickToShow': 'Click "Show" to view history',

    '404.title': '404 Page Not Found',
    '404.hint': 'Did you forget to add the page to the router?',

    'results.tokenLabel': 'Tokens',
    'results.profitLabel': 'Profit',

    'calc.title': 'Calculator',
    'calc.investment': 'Initial Investment (USD)',
    'calc.gemsConsumed': 'Gems Consumed',
    'calc.loadsUsed': 'Loads Used',
    'calc.gemsPurchased': 'Gems Purchased',
    'calc.tokensEquipment': 'Acceleration token spent',
    'calc.tokenPrice': 'Token Price (USD)',
    'calc.currentPrice': 'Current WorldShards Price',
    'calc.updated': 'Updated',
    'calc.outdated': 'Outdated',
    'calc.refreshPrice': 'Refresh token price',
    'calc.error': 'Error',
    'calc.gemsRemaining': 'Gems Remaining',
    'calc.tokensFarmed': 'Farmed Tokens',
    'calc.gemPrice': 'Gem Price (USD)',
    'calc.button': 'Calculate Net Profit',

    'sidebar.summary': 'Quick Summary',
    'sidebar.totalProfit': 'Total Profit',
    'sidebar.roi': 'ROI',
    'sidebar.efficiency': 'Efficiency',
    'sidebar.nav.calculator': 'Calculator',
    'sidebar.nav.equipment': 'Equipment',
    'sidebar.nav.history': 'History',

    'home.calculator': 'Calculator',
    'home.title': 'ProfitShards Tools',
    'home.hero.title': 'Maximize Your Profits',
    'home.hero.subtitle': 'Calculate, plan and optimize your WorldShards farming with professional tools and community data.',
    'home.hero.cta.start': 'Start Calculating',
    'home.hero.cta.register': 'Create Free Account',
    'home.features.title': 'Your Success Tools',
    'home.features.subtitle': 'Everything you need to master WorldShards in one place',
    'home.features.calculator.title': 'Advanced Calculator',
    'home.features.calculator.description': 'Calculate your profits with precision, considering all factors: investment, gems, luck and efficiency.',
    'home.features.calculator.badge1': 'Real-time ROI',
    'home.features.calculator.badge2': 'Advanced simulation',
    'home.features.map.title': 'Map Planner',
    'home.features.map.description': 'Record your runs, analyze efficiency and contribute to community statistics.',
    'home.features.map.badge1': 'Complete history',
    'home.features.map.badge2': 'Detailed metrics',
    'home.features.analytics.title': 'Advanced Analytics',
    'home.features.analytics.description': 'Complete dashboards, detailed history and insights to optimize your strategy.',
    'home.features.analytics.badge1': 'Dynamic charts',
    'home.features.analytics.badge2': 'Comparisons',
    'home.community.title': 'Community Activity',
    'home.community.subtitle': 'See in real time what other players are doing. Get inspired and compete!',
    'home.cta.title': 'Ready to Start Your Journey? üöÄ',
    'home.cta.subtitle': 'Join hundreds of players who are already maximizing their WorldShards profits',
    
    // Login Required Messages
    'home.loginRequired.all': 'üîê Login required to access all features!\n\nSign in with your account to use Calculator, Planner and Statistics.',
    'home.loginRequired.feed': 'üîê Login required to appear in community feed!\n\nUse the tools and your activities will appear here for everyone to see.',
    'home.loginRequired.calculator': 'üîê Login required to access Calculator!\n\nAccess your profile to start calculating your profits.',
    'home.loginRequired.planner': 'üîê Login required to access Map Planner!\n\nAccess your profile to plan your strategies.',
    'home.loginRequired.stats': 'üîê Login required to access Statistics!\n\nAccess your profile to see your complete dashboard.',
    'home.loginRequired.giveaway': 'üîê Login required to participate in Giveaway!\n\nSign in with your account to compete for prizes.',
    'home.walletCopied': 'Wallet copied to clipboard!',
    'home.cta.try': 'Try Now (Free)',
    'home.cta.features': 'See More Features',
    'home.footer.description': 'The ultimate platform for smart farming. Developed by the community, for the community.',
    'home.footer.feature1': 'Precise Calculations',
    'home.footer.feature2': 'Advanced Analytics',
    'home.footer.feature3': 'Active Community',
    'home.footer.feature4': 'Completely Free',
    'home.welcome.title': 'Welcome back, {username}! üëã',
    'home.welcome.subtitle': 'Ready for another profitable farming session?',
    'home.welcome.profile': 'Go to Profile',
    'home.goToProfile': 'Access Tools',
    'home.startCalculating': 'Start Calculating',
    
    // WorldShards Resources Section
    'home.resources.title': 'Access the game, marketplace and get help',
    'home.resources.yourTurn': 'Your turn!',
    'home.resources.makeRun': 'Make your run and appear here for the whole community to see',
    'home.resources.startCalculating': 'Start Calculating',
    
    // Support Section
    'support.feedback': 'Feedback & Support',

    // Navigation
    'nav.backToMain': 'Back to Main Menu',
    'nav.openProfile': 'Open Profile (Luck: {luck})',
    'nav.openProfileUser': 'Open Profile ({user})',

    'auth.guest': 'Guest',

    'donate.title': 'Donation',
    'donate.openloot': 'Creator OL',
    'donate.wallet': 'EVM Wallet',
    'donate.copy': 'Copy',
    'donate.copied': 'Copied!',
    'support.title': 'Support the Project',
    'support.ambassador': 'OpenLoot (Ambassador)',
    'support.ambassador.cta': 'Ambassador OpenLoot',
    'support.ambassador.desc': 'Use my ambassador link',
    'support.donate': 'Donate to keep the site online',
    'support.creator': 'Created by',
    'planner.title': 'Map Planner',
    'planner.mapSize': 'Map size',
    'planner.small': 'Small',
    'planner.medium': 'Medium',
    'planner.large': 'Large',
    'planner.xlarge': 'Extra large',
    'planner.energyCost': 'Energy per map',
    'planner.loads': 'Loads (runs)',
    'planner.tokensDropped': 'Tokens dropped',
    'planner.luck': 'Luck',
    'planner.status': 'Status',
    'planner.apply': 'Save to mini history',
    'planner.example': 'e.g., 30 on medium map',
    'planner.history': 'Mini history (2 days)',
    'planner.noHistory': 'No drop records in last 2 days',
    'planner.when': 'When',
    'metrics.title': 'Metrics (last 2 days)',
    'metrics.title24h': 'Metrics (last 24h)',
    'metrics.avgPerRun': 'Avg tokens per load',
    'metrics.totalByDay': 'Total per day',
    'metrics.bestHour': 'Best hour',
    'metrics.noData': 'No data yet',
    'metrics.todayTitle': 'Metrics (today since 05:00)',
    'metrics.avgPerRunToday': 'Average tokens per load (today)',
    'metrics.totals': 'Totals',
    'metrics.todayFromTime': 'Today (since 05:00)',
    'metrics.yesterdayRange': 'Yesterday (05:00 ‚Üí 05:00)',
    'metrics.bestHourToday': 'Best hour (today)',
    'metrics.runShort': 'load',
    'planner.clear': 'Clear history',
    'planner.delete': 'Delete',

    // WorldShards Resources
    'resources.game.title': 'Play Now',
    'resources.game.desc': 'Access WorldShards game and start your adventure',
    'resources.game.cta': 'Play',
    'resources.marketplace.title': 'Marketplace',
    'resources.marketplace.desc': 'Buy and sell items, equipment and tokens',
    'resources.marketplace.cta': 'OpenLoot',
    'resources.faq.title': 'FAQ & Help',
    'resources.faq.desc': 'Frequently asked questions and usage guides',
    'resources.faq.cta': 'View FAQ',

    // FAQ Section
    'faq.title': 'Frequently Asked Questions',
    'faq.subtitle': 'Get answers about WorldShards Calculator',
    'faq.calculator.question': 'How does the profit calculator work?',
    'faq.calculator.answer': 'The calculator analyzes your investment, equipment, luck and efficiency to determine potential profit in dungeons. Enter your setup data and receive detailed analysis with ROI, token distribution and recommendations.',
    'faq.planner.question': 'What is the map planner?',
    'faq.planner.answer': 'The planner allows you to record your runs, analyze efficiency by map (Small, Medium, Large, XLarge) and contribute to community statistics. Track your progress and compare with other players.',
    'faq.stats.question': 'How do community statistics work?',
    'faq.stats.answer': 'Statistics are updated in real-time with anonymous user data. You can see recent runs, total profits, active players and most popular maps. All data is aggregated and does not identify individual users.',
    'faq.tokens.question': 'Are token prices updated automatically?',
    'faq.tokens.answer': 'Currently we use fixed prices for calculations. Soon we will implement integration with real-time price APIs to reflect current market prices. You can track current prices on CoinGecko.',
    'faq.export.question': 'Can I export my data and history?',
    'faq.export.answer': 'Yes! In your profile you can download your entire calculation and run history in JSON format. You can also clear data individually or make complete backups of your information.',
    'faq.offline.question': 'Does the site work offline?',
    'faq.offline.answer': 'Partially yes! The calculator and history work offline after first load. Only features that depend on community data (feed, statistics) need internet connection.',

    // Status labels
    'status.excellent': 'Excellent',
    'status.positive': 'Positive',
    'status.negative': 'Negative',
    'status.neutral': 'Neutral',

    // Profile page
    'profile.title': 'Profile',
    'profile.welcome': 'Hello, {name}! üëã',
    'profile.subtitle': 'Settings and history automatically synchronized',
    'profile.subtitleLocal': 'Data saved locally in browser',
    'profile.of': '{name}\'s Profile',
    'profile.tabs.calculator': 'Calculator',
    'profile.tabs.history': 'History',
    'profile.tabs.planner': 'Planner',
    'profile.tabs.test': 'Test',
    'profile.history.clear': 'Clear All',
    'profile.history.empty': 'Make some calculations on the homepage to see history here',
    'profile.history.stats.title': 'Statistical Summary',
    'profile.history.stats.calculations': 'Calculations',
    'profile.history.stats.avgProfit': 'Average Profit',
    'profile.history.stats.bestProfit': 'Best Profit',
    'profile.history.stats.successRate': 'Success Rate',
    'profile.history.remove': 'Remove',
    'profile.history.removeTitle': 'Remove this calculation',
    'profile.history.investment': 'Investment',
    'profile.history.tokens': 'Tokens',
    'profile.history.gems': 'Gems',
    'profile.history.efficiency': 'Efficiency',

    // Equipment settings
    'equipment.userSettings': 'User Settings',
    'equipment.nickname': 'Nickname',
    'equipment.nicknameEdit': 'Edit',
    'equipment.nicknameSave': 'Save',
    'equipment.nicknameCancel': 'Cancel',
    'equipment.nicknamePlaceholder': 'Enter your nickname',
    'equipment.nicknameDescription': 'Your nickname will be displayed publicly in rankings and statistics',
    'equipment.nicknameLoading': 'Loading...',

    // Analytics Dashboard
    'analytics.title': 'Advanced Analytics',
    'analytics.globalData': 'Global Data',
    'analytics.adminTools': 'Admin Tools',
    'analytics.update': 'Update',
    'analytics.loading': 'Loading analytics...',
    'analytics.loadingGlobal': 'Loading global data...',
    'analytics.hourlyActivity': 'Hourly Activity',
    'analytics.mapEfficiency': 'Map Efficiency',
    'analytics.topUsers': 'Top Users',
    'analytics.totalRuns': 'Total Runs',
    'analytics.totalTokens': 'Total Tokens',
    'analytics.activeUsers': 'Active Users',
    'analytics.globalAverage': 'Global Average',
    'analytics.luckRange': 'Luck Range',
    'analytics.runs': 'Runs',
    'analytics.tokens': 'Tokens',
    'analytics.average': 'Average',
    'analytics.users': 'Users',

    // Admin Tools
    'admin.title': 'Administrative Tools',
    'admin.exportData': 'Export Data',
    'admin.exportDescription': 'Download all system data',
    'admin.exportCSV': 'CSV',
    'admin.exportJSON': 'JSON',
    'admin.backupDatabase': 'Backup Database',
    'admin.backupDescription': 'Create complete D1 backup',
    'admin.createBackup': 'Create Backup',
    'admin.cleanData': 'Data Cleanup',
    'admin.cleanDescription': 'Remove old data (90+ days)',
    'admin.cleanOld': 'Clean Old Data',
    'admin.testD1': 'Test D1',
    'admin.testD1Description': 'Test database connectivity',
    'admin.testDatabase': 'Test D1',
    'admin.processing': 'Processing...',

    // Test Dashboard
    'test.dashboard': 'Test Dashboard',
    'test.worldshards': 'WorldShards Dashboard',
    'test.subtitle': 'Real-time farming analytics and insights',
    'test.totalFarms': 'Total Farms',
    'test.totalTokens': 'Total Tokens',
    'test.avgEfficiency': 'Average Efficiency',
    'test.activeUsers': 'Active Users',
    'test.hourlyActivity': 'Hourly Activity',
    'test.topMaps': 'Top Maps',
    'test.recentActivity': 'Recent Activity',
    'test.efficiencyTrends': 'Efficiency Trends',

    // Common
    'common.error': 'Error',
    'common.success': 'Success',
    'common.loading': 'Loading',
    'common.save': 'Save',
    'common.cancel': 'Cancel',
    'common.edit': 'Edit',
    'common.delete': 'Delete',
    'common.copy': 'Copy',
  },
};

const LangContext = createContext<{ lang: Lang; setLang: (l: Lang) => void; t: (k: string, vars?: Record<string, string>) => string }>({ lang: 'pt', setLang: () => {}, t: (k) => k });

export function I18nProvider({ children }: { children: React.ReactNode }) {
  const [lang, setLangState] = useState<Lang>('pt');

  useEffect(() => {
    const saved = localStorage.getItem('worldshards-lang') as Lang | null;
    if (saved === 'en' || saved === 'pt') setLangState(saved);
  }, []);

  const setLang = (l: Lang) => {
    setLangState(l);
    localStorage.setItem('worldshards-lang', l);
    window.dispatchEvent(new CustomEvent('worldshards-lang-updated'));
  };

  const t = useMemo(() => (key: string, vars?: Record<string, string>) => {
    let text = dicts[lang][key] ?? key;
    if (vars) {
      Object.entries(vars).forEach(([varKey, varValue]) => {
        text = text.replace(`{${varKey}}`, varValue);
      });
    }
    return text;
  }, [lang]);

  return React.createElement(LangContext.Provider, { value: { lang, setLang, t } }, children);
}

export function useI18n() {
  return useContext(LangContext);
}